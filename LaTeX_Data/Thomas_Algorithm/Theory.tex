\chapter{Numerical Methods}
\begin{comment}
\end{comment}
%Seperator
%Seperator
%Seperator
%Seperator
%Seperator
\section{Thomas Method: Tridiagonal Systems}
\begin{comment}
\end{comment}

Consider a single row in the tri-diagonal system,
$$\beta_j\phi_{j-1} + D_j\phi_{j} + \alpha_j\phi_{j+1} = C_j$$
Suppose the perceding row in the tri-diagonal system,
$$D_{j-1}\phi_{j-1} + \alpha_{j-1}\phi_{j} = C_{j-1}$$
The forward sweep of the thomas algorithm seeks to eliminate the sub-diagonal terms of the tri-diagonal system. For the two rows of the tri-diagonal system shown above, the sub-diagonal term is $\phi_{j-1}$. Manpulating the perceding row,
$$D_{j-1}\beta_j\phi_{j-1} + \alpha_{j-1}\beta_j\phi_{j} = \beta_jC_{j-1}$$
Manipulating the following row,
$$\beta_jD_{j-1}\phi_{j-1} + D_jD_{j-1}\phi_{j} + \alpha_jD_{j-1}\phi_{j+1} = D_{j-1}C_j$$
Subtracting the following row by the perceding row
$$\beta_jD_{j-1}\phi_{j-1} + D_jD_{j-1}\phi_{j} + \alpha_jD_{j-1}\phi_{j+1} - D_{j-1}\beta_j\phi_{j-1} - \alpha_{j-1}\beta_j\phi_{j} = D_{j-1}C_j - \beta_jC_{j-1}$$
$$D_jD_{j-1}\phi_{j} - \alpha_{j-1}\beta_j\phi_{j} + \alpha_jD_{j-1}\phi_{j+1} = D_{j-1}C_j - \beta_jC_{j-1}$$
$$[D_jD_{j-1} - \alpha_{j-1}\beta_j]\phi_{j} + \alpha_jD_{j-1}\phi_{j+1} = D_{j-1}C_j - \beta_jC_{j-1}$$
$$\phi_{j} + \left[\frac{\alpha_jD_{j-1}}{D_jD_{j-1} - \alpha_{j-1}\beta_j}\right]\phi_{j+1} = \frac{D_{j-1}C_j - \beta_jC_{j-1}}{D_jD_{j-1} - \alpha_{j-1}\beta_j}$$  
The results above would Complete the forward sweep of the thomas algorithm for the first row until the sec
ond last row. The last row is simply a more speCific case of the expression above wherein $a_j = 0$. Substituting for only the last row,
$$\phi_{j} = \frac{D_{j-1}C_j - \beta_jC_{j-1}}{D_jD_{j-1} - \alpha_{j-1}\beta_j}$$
The last row in the tri-diagonal system is solved after the forward sweep of the thomas algorithm. After t
he forward sweep of the thomas algorithm, the perceding row,
$$\phi_{j} + \alpha_{j}\phi_{j+1} = C_{j}$$
The following row,
$$\phi_{j+1} = C_{j+1}$$
Substituting the following row to the perceding row,
$$\phi_{j} + \alpha_{j}C_{j+1} = C_{j}$$
$$\phi_{j} = C_{j} - \alpha_{j}C_{j+1}$$
This would be true because the main diagonal after the forward sweep of the thomas algorithm would all be just $1$. The Thomas algorithm implemented in fortran is shown below,
